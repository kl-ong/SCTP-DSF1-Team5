{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.2", "generated_at": "2025-06-12T07:11:07.295740Z", "invocation_id": "1e814228-1fad-4580-ae09-eb5edba546fe", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:19.664949Z", "completed_at": "2025-06-12T07:10:19.682488Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:19.684140Z", "completed_at": "2025-06-12T07:10:25.006486Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.343894004821777, "adapter_response": {"_message": "CREATE TABLE (96.5k rows, 11.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 96461, "bytes_processed": 11792569, "bytes_billed": 12582912, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "562fae66-f5a5-409d-ac9b-60a9bbe0b87b", "slot_ms": 11277}, "message": "CREATE TABLE (96.5k rows, 11.2 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_orders_stg", "compiled": true, "compiled_code": "\n\nSELECT \n  order_id,\n  customer_id,\n  order_status,\n  order_purchase_timestamp,\n  order_approved_at,\n  order_delivered_carrier_date,\n  order_delivered_customer_date,\n  order_estimated_delivery_date,\n  CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`olist_orders_dataset` \nWHERE \n\torder_id IS NOT NULL\n\tAND customer_id IS NOT NULL\n   \tAND order_status IS NOT NULL\n   \tAND order_purchase_timestamp IS NOT NULL\n   \tAND order_approved_at IS NOT NULL\n   \tAND order_delivered_carrier_date IS NOT NULL \n   \tAND order_delivered_customer_date IS NOT NULL \n   \tAND order_estimated_delivery_date IS NOT NULL\n   \tAND order_id <> ''\n\tAND customer_id <> ''\n   \tAND order_status <> ''", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_orders_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:25.015114Z", "completed_at": "2025-06-12T07:10:25.021562Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:25.022487Z", "completed_at": "2025-06-12T07:10:29.785207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.772090911865234, "adapter_response": {"_message": "CREATE TABLE (72.0 rows, 2.6 KiB processed)", "code": "CREATE TABLE", "rows_affected": 72, "bytes_processed": 2684, "bytes_billed": 10485760, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "68564f37-2ffc-429b-a600-f7f8bac80026", "slot_ms": 7156}, "message": "CREATE TABLE (72.0 rows, 2.6 KiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_product_category_name_translation_stg", "compiled": true, "compiled_code": "\n\nSELECT\n\tCAST(string_field_0 AS STRING) AS product_category_name,\n\tCAST(string_field_1 AS STRING) AS product_category_name_english,\n    CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`product_category_name_translation` \nWHERE \n\tstring_field_0 IS NOT NULL\n\tAND string_field_1 IS NOT NULL\n\tAND string_field_0 <> ''\n\tAND string_field_1 <> ''", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_product_category_name_translation_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:29.794101Z", "completed_at": "2025-06-12T07:10:29.802418Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:29.804084Z", "completed_at": "2025-06-12T07:10:34.118416Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.327069997787476, "adapter_response": {"_message": "CREATE TABLE (32.3k rows, 3.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 32340, "bytes_processed": 3499346, "bytes_billed": 10485760, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "609ff137-67f3-41c4-a847-a19b1485b678", "slot_ms": 11129}, "message": "CREATE TABLE (32.3k rows, 3.3 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_products_stg", "compiled": true, "compiled_code": "\n\nSELECT \n    product_id,\n    product_category_name,\n    product_name_lenght,\n    product_description_lenght,\n    product_photos_qty,\n    product_weight_g,\n    product_length_cm,\n    product_height_cm,\n    product_width_cm,\n    CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`olist_products_dataset`\nWHERE \n\tproduct_id IS NOT NULL \n\tAND product_category_name IS NOT NULL \n\tAND product_name_lenght IS NOT NULL \n\tAND product_description_lenght IS NOT NULL \n\tAND product_photos_qty IS NOT NULL \n\tAND product_weight_g IS NOT NULL \n\tAND product_length_cm IS NOT NULL \n\tAND product_height_cm IS NOT NULL \n\tAND product_width_cm IS NOT NULL \n\tAND product_id <> ''\n\tAND product_category_name <> ''", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_products_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:34.127369Z", "completed_at": "2025-06-12T07:10:34.135821Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:34.136817Z", "completed_at": "2025-06-12T07:10:38.036481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.911968946456909, "adapter_response": {"_message": "CREATE TABLE (3.1k rows, 175.8 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3095, "bytes_processed": 180030, "bytes_billed": 10485760, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "f5401d93-7ac3-46d5-a290-f9ea33b31c5c", "slot_ms": 7899}, "message": "CREATE TABLE (3.1k rows, 175.8 KiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_sellers_stg", "compiled": true, "compiled_code": "\n\nSELECT\n    seller_id,\n    seller_zip_code_prefix,\n    seller_city,\n    seller_state,\n    CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`olist_sellers_dataset`\nWHERE \n\tseller_id IS NOT NULL \n\tAND seller_zip_code_prefix IS NOT NULL\n\tAND seller_city IS NOT NULL\n\tAND seller_state IS NOT NULL \n\tAND seller_id <> '' \n\tAND seller_city <> ''\n\tAND seller_state <> ''", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_sellers_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:38.045483Z", "completed_at": "2025-06-12T07:10:38.052701Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:38.053362Z", "completed_at": "2025-06-12T07:10:42.006245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.96345591545105, "adapter_response": {"_message": "CREATE TABLE (1.0k rows, 14.4 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1000, "bytes_processed": 15095100, "bytes_billed": 15728640, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "9546fa35-50e7-4dac-807e-ad3c2eb6e524", "slot_ms": 5903}, "message": "CREATE TABLE (1.0k rows, 14.4 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.fact_order_items_stg", "compiled": true, "compiled_code": "\n\nSELECT\n    order_id,\n    order_item_id,\n    product_id,\n    seller_id,\n    shipping_limit_date,\n    price,\n    freight_value,\n    CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`olist_order_items_dataset`\nWHERE \n\torder_id IS NOT NULL\n\tAND order_item_id IS NOT NULL\n   \tAND product_id IS NOT NULL\n   \tAND seller_id IS NOT NULL\n   \tAND shipping_limit_date IS NOT NULL\n   \tAND price IS NOT NULL \n   \tAND freight_Value IS NOT NULL\n   \tAND order_id <> ''\n\tAND product_id <> ''\n\tAND seller_id <> ''\nLIMIT 1000", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`fact_order_items_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:42.017588Z", "completed_at": "2025-06-12T07:10:42.025337Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:42.026545Z", "completed_at": "2025-06-12T07:10:45.763916Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.7490410804748535, "adapter_response": {"_message": "CREATE TABLE (1.0k rows, 6.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1000, "bytes_processed": 7252357, "bytes_billed": 10485760, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "d4fa2808-48ca-42e2-84fb-e6e1a9c08310", "slot_ms": 4294}, "message": "CREATE TABLE (1.0k rows, 6.9 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.fact_order_payments_stg", "compiled": true, "compiled_code": "\n\nSELECT\n    order_id,\n    payment_sequential,\n    payment_type,\n    payment_installments,\n    payment_value,\n    CURRENT_TIMESTAMP() AS last_extract_ts\nFROM `dsai-brazilian-ecommerce`.`Brazilian_Ecommerce`.`olist_order_payments_dataset`\nWHERE \n\torder_id IS NOT NULL\n\tAND payment_sequential IS NOT NULL\n   \tAND payment_type IS NOT NULL\n   \tAND payment_installments IS NOT NULL\n   \tAND payment_value IS NOT NULL\n   \tAND order_id <> '' \n   \tAND payment_type <> ''\nLIMIT 1000", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist_stg`.`fact_order_payments_stg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:45.774252Z", "completed_at": "2025-06-12T07:10:45.784289Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:45.785598Z", "completed_at": "2025-06-12T07:10:50.569816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.798835039138794, "adapter_response": {"_message": "CREATE TABLE (96.5k rows, 10.9 MiB processed)", "code": "CREATE TABLE", "rows_affected": 96461, "bytes_processed": 11478853, "bytes_billed": 11534336, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "98aa4217-0912-464a-845e-577628310e97", "slot_ms": 11418}, "message": "CREATE TABLE (96.5k rows, 10.9 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_orders_analysis", "compiled": true, "compiled_code": "\n\nwith orders_stg as (\n    SELECT *\n    FROM `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_orders_stg`\n    \n    \n)\n\nSELECT\n    order_id,\n    customer_id,\n    order_status,\n    EXTRACT(DAY FROM (order_delivered_customer_date - order_purchase_timestamp)) AS final_order_fullfilment_days,\n    order_purchase_timestamp,\n    order_approved_at,\n    order_delivered_carrier_date,\n    order_delivered_customer_date,\n    order_estimated_delivery_date\nFROM orders_stg \nWHERE order_id IS NOT NULL", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist`.`dim_orders_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:50.579657Z", "completed_at": "2025-06-12T07:10:50.589233Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:50.589960Z", "completed_at": "2025-06-12T07:10:55.253511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.6771440505981445, "adapter_response": {"_message": "CREATE TABLE (32.3k rows, 3.3 MiB processed)", "code": "CREATE TABLE", "rows_affected": 32340, "bytes_processed": 3461737, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "c28a2551-d164-43bf-b810-8d0033c8bf6f", "slot_ms": 9224}, "message": "CREATE TABLE (32.3k rows, 3.3 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_products_analysis", "compiled": true, "compiled_code": "\n\n\n-- models/star/dim_products_analysis.sql\nSELECT\n    p.product_id,\n    t.product_category_name_english,\n    p.product_category_name,\n    p.product_name_lenght,\n    p.product_description_lenght,\n    p.product_photos_qty,\n    CASE WHEN p.product_weight_g > 0 THEN p.product_weight_g ELSE NULL END AS product_weight_g,\n    CASE WHEN p.product_length_cm > 0 THEN p.product_length_cm ELSE NULL END AS product_length_cm,\n    CASE WHEN p.product_height_cm > 0 THEN p.product_height_cm ELSE NULL END AS product_height_cm,\n    CASE WHEN p.product_width_cm > 0 THEN p.product_width_cm ELSE NULL END AS product_width_cm\nFROM `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_products_stg` p\nLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_product_category_name_translation_stg` t\n    ON p.product_category_name = t.product_category_name\nWHERE p.product_id IS NOT NULL\n  AND p.product_category_name IS NOT NULL", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist`.`dim_products_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:55.261934Z", "completed_at": "2025-06-12T07:10:55.268675Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:55.269575Z", "completed_at": "2025-06-12T07:10:58.904106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.6441471576690674, "adapter_response": {"_message": "CREATE TABLE (3.9k rows, 242.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 3903, "bytes_processed": 248030, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "c990cadf-bcb8-4ad2-ae3e-3c43e876b934", "slot_ms": 9909}, "message": "CREATE TABLE (3.9k rows, 242.2 KiB processed)", "failures": null, "unique_id": "model.dbt_olist.dim_sellers_analysis", "compiled": true, "compiled_code": "\n\n-- models/star/dim_sellers.sql\nSELECT\n    s.seller_id,\n    oi.order_id,    \n    s.seller_zip_code_prefix,\n    TRIM(INITCAP(s.seller_city)) AS seller_city,\n    s.seller_state\nFROM `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_sellers_stg` s\nLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`fact_order_items_stg` oi ON s.seller_id = oi.seller_id\nWHERE \n\ts.seller_id IS NOT NULL", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist`.`dim_sellers_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:10:58.911090Z", "completed_at": "2025-06-12T07:10:58.918780Z"}, {"name": "execute", "started_at": "2025-06-12T07:10:58.919374Z", "completed_at": "2025-06-12T07:11:02.931360Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.02217698097229, "adapter_response": {"_message": "CREATE TABLE (1.0k rows, 11.0 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1000, "bytes_processed": 11547669, "bytes_billed": 20971520, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "e3f1cdca-4da6-419e-a67d-ad8f0f87d1fa", "slot_ms": 5745}, "message": "CREATE TABLE (1.0k rows, 11.0 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.fact_order_payments_analysis", "compiled": true, "compiled_code": "\n\n\n\n-- models/star/fact_order_payments.sql\n-- This model focuses on payment transaction details.\n-- You might choose to aggregate payments per order here if needed,\n-- or keep it granular per payment_sequential.\n\nSELECT\n    op.order_id,\n    op.payment_sequential,\n    op.payment_type,\n    op.payment_installments,\n    op.payment_value,\n    o.customer_id,\n    o.order_status,\n    o.order_purchase_timestamp,\n    o.order_approved_at,\n    o.order_delivered_carrier_date,\n    o.order_delivered_customer_date,\n    o.order_estimated_delivery_date\nFROM `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`fact_order_payments_stg` AS op\nLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist`.`dim_orders_analysis` AS o\n    ON op.order_id = o.order_id\nWHERE op.order_id IS NOT NULL", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist`.`fact_order_payments_analysis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-12T07:11:02.940920Z", "completed_at": "2025-06-12T07:11:02.950395Z"}, {"name": "execute", "started_at": "2025-06-12T07:11:02.951597Z", "completed_at": "2025-06-12T07:11:07.286123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.347833156585693, "adapter_response": {"_message": "CREATE TABLE (1.0k rows, 10.6 MiB processed)", "code": "CREATE TABLE", "rows_affected": 1000, "bytes_processed": 11134004, "bytes_billed": 62914560, "location": "US", "project_id": "dsai-brazilian-ecommerce", "job_id": "dc03f209-c6a6-4a32-ba8f-0c906f8a6d5e", "slot_ms": 8354}, "message": "CREATE TABLE (1.0k rows, 10.6 MiB processed)", "failures": null, "unique_id": "model.dbt_olist.fact_order_items_analysis", "compiled": true, "compiled_code": "\n\n\n-- models/star/fact_order_items.sql\n-- This model creates the fact_order_items table, centralizing order item details,\n-- linking to dimensions, and calculating key metrics.\n\nSELECT\n    o.order_id,\n    o.customer_id,\n    s.seller_id, \n    t.product_category_name_english,\n    oi.order_item_id,\n    EXTRACT(DAY FROM (o.order_delivered_customer_date - o.order_purchase_timestamp)) AS final_order_fullfilment_days,\n    o.order_status,\n    oi.price,\n    oi.freight_value,\n    (oi.price + oi.freight_value) AS total_sale_amount, \n    FIRST_VALUE(op.payment_type) OVER (PARTITION BY o.order_id ORDER BY op.payment_type) AS payment_type,\n    FIRST_VALUE(op.payment_installments) OVER (PARTITION BY o.order_id ORDER BY op.payment_type) AS payment_installments,\n    FIRST_VALUE(op.payment_value) OVER (PARTITION BY o.order_id ORDER BY op.payment_type) AS payment_value\n\nFROM `dsai-brazilian-ecommerce`.`dbt_olist`.`dim_orders_analysis` AS o\n\n\tJOIN `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`fact_order_items_stg` AS oi\n\t    ON o.order_id = oi.order_id\n\tLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist`.`fact_order_payments_analysis` AS op\n\t    ON o.order_id = op.order_id\n\tLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist`.`dim_products_analysis` AS p\n\t    ON oi.product_id = p.product_id\n\tLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist_stg`.`dim_product_category_name_translation_stg` AS t\n    \tON p.product_category_name = t.product_category_name\n\tLEFT JOIN `dsai-brazilian-ecommerce`.`dbt_olist`.`dim_sellers_analysis` AS s\n\t    ON oi.seller_id = s.seller_id\nWHERE \n\to.order_id IS NOT NULL \n\tAND \n\toi.order_item_id IS NOT NULL\nLIMIT 1000", "relation_name": "`dsai-brazilian-ecommerce`.`dbt_olist`.`fact_order_items_analysis`", "batch_results": null}], "elapsed_time": 50.23710298538208, "args": {"use_colors_file": true, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "invocation_command": "dbt run", "exclude": [], "require_resource_names_without_spaces": false, "log_format": "default", "strict_mode": false, "print": true, "log_level": "info", "select": [], "quiet": false, "cache_selected_only": false, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "log_file_max_bytes": 10485760, "project_dir": "/Users/taysk/sctp/Project/SCTP-DSF1-Team5/03 - Code/dbt_olist", "version_check": true, "defer": false, "log_path": "/Users/taysk/sctp/Project/SCTP-DSF1-Team5/03 - Code/dbt_olist/logs", "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "use_colors": true, "empty": false, "macro_debugging": false, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "which": "run", "state_modified_compare_vars": false, "send_anonymous_usage_stats": true, "introspect": true, "log_format_file": "debug", "write_json": true, "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "populate_cache": true, "partial_parse_file_diff": true, "profiles_dir": "/Users/taysk/sctp/Project/SCTP-DSF1-Team5/03 - Code/dbt_olist", "printer_width": 80}}